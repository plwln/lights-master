{% extends "base.html" %}
{% block content %}
<div class="row">
    <div class="col-12 col-sm-2 col-md-2 col-xl-2 grid-margin stretch-card">
        <div class="card">
            <div class="card-body px-0 pb-0 border-bottom">
                <div class="px-4">
                    <div class="d-flex justify-content-between">
                        <h6 class="card-title ">Список цехов</h6>
                    </div>
                </div>
            </div>
            <div class="card-body px-1 pt-3">
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    {%for workshop in workshops%}
                    <a class="nav-link workshopLinks" id="shop{{workshop.id}}" data-toggle="pill"
                        href="#v{{workshop.id}}" role="tab" aria-controls="v-pills-home" aria-selected="false"
                        workshop={{workshop.id}}>{{workshop.name}}</a>
                    {%endfor%}

                </div>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-10 col-md-10 col-xl-10 grid-margin stretch-card px-0">
        <div class="card">
            <div class="card-body px-0 pb-0 border-bottom">
                <div class="d-flex justify-content-between mb-2 px-2">
                    <h4 class="card-title ml-2" id='title'>Распиловочный участок</h4>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $(document).on('click', '.workshopLinks', function () {
            shop = $(this).text();
            $('#title').text(shop);
            req = $.ajax({
                url: '/workshop_orders',
                type: 'POST',
                data: {
                    'shop': shop,
                }
            });
            req.done(function (data) {
                $('.table-responsive').html(data);
            });
        });
        $('#shop1').click();
        $(document).on('click', '.report', function () {
            stock = $(this).attr('stock_id');
            console.log('#wc' + stock)
            workflow_count = $('#wc' + stock).val()
            console.log(workflow_count)
            req = $.ajax({
                url: '/workflow_count',
                type: 'POST',
                data: {
                    'stock': stock,
                    'workflow_count': workflow_count,
                }
            });
            req.done(function (data) {
                $('#row' + stock).html(data);
                $('body').removeClass('modal-open')
                $('.modal-backdrop').remove();
            });
        });

    });
</script>
{%endblock%}